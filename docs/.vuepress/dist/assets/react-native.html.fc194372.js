import{_ as p,r as o,o as c,c as i,a as n,b as e,F as l,e as t,d as a}from"./app.28f6b3e6.js";const r={},u=t(`<h1 id="react-native-and-solana" tabindex="-1"><a class="header-anchor" href="#react-native-and-solana" aria-hidden="true">#</a> React Native and Solana</h1><p>React Native is an open-source UI software framework used to develop mobile, web and desktop applications by enabling developers to use the React framework along with native platform capabilities. Powered with the Solana SDK, this is a great platform to quickly build performant native Crypto apps.</p><p>The fastest way to start with React Native and Solana is by using the <a href="#solana-dapp-scaffold-for-react-native">Solana DApp Scaffold for React Native</a>.</p><h2 id="how-to-use-solana-web3-js-in-a-react-native-app" tabindex="-1"><a class="header-anchor" href="#how-to-use-solana-web3-js-in-a-react-native-app" aria-hidden="true">#</a> How to use @solana/web3.js in a React Native app</h2><p>In this tutorial you will learn how to create a new React Native app and install and configure the <code>@solana/web3.js</code> SDK, and its dependencies.</p><p>If you already have an existing app, skip to <a href="#install-dependencies">installing the dependencies</a>.</p><h3 id="create-a-new-app" tabindex="-1"><a class="header-anchor" href="#create-a-new-app" aria-hidden="true">#</a> Create a new app</h3><p>We start a new React Native application that uses TypeScript, then <code>cd</code> into the project directory, where we will execute the rest of the commands.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>npx react-native@0.70.0 init SolanaReactNative --template react-native-template-typescript
<span class="token builtin class-name">cd</span> SolanaReactNative
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="install-dependencies" tabindex="-1"><a class="header-anchor" href="#install-dependencies" aria-hidden="true">#</a> Install dependencies</h3><p>Next, we install the dependencies. The Solana JavaScript SDK, a package to patch the React Native build system (Metro), a secure random number generator, and a fix to patch React Native&#39;s missing <code>URL</code> class.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">yarn</span> <span class="token function">add</span> <span class="token punctuation">\\</span>
  @solana/web3.js <span class="token punctuation">\\</span>
  react-native-get-random-values <span class="token punctuation">\\</span>
  react-native-url-polyfill
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="patch-babel-to-use-the-hermes-transforms" tabindex="-1"><a class="header-anchor" href="#patch-babel-to-use-the-hermes-transforms" aria-hidden="true">#</a> Patch Babel to use the Hermes transforms</h3><p>As of August 2022 the template from which new React Native apps are made enables the Hermes JavaScript engine by default but not the Hermes code transforms. Enable them by making the following change to <code>babel.config.js</code>:</p><div class="language-diff ext-diff line-numbers-mode"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   presets: [&#39;module:metro-react-native-babel-preset&#39;],
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   presets: [
</span><span class="token prefix inserted">+</span><span class="token line">     [
</span><span class="token prefix inserted">+</span><span class="token line">       &#39;module:metro-react-native-babel-preset&#39;,
</span><span class="token prefix inserted">+</span><span class="token line">       {unstable_transformProfile: &#39;hermes-stable&#39;},
</span><span class="token prefix inserted">+</span><span class="token line">     ],
</span><span class="token prefix inserted">+</span><span class="token line">   ],
</span></span>};
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="update-index-js" tabindex="-1"><a class="header-anchor" href="#update-index-js" aria-hidden="true">#</a> Update <code>index.js</code></h3><p>To load the polyfills, we open the file <code>index.js</code> in the root of the project and add the following two lines to the top of the file:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token string">&#39;react-native-get-random-values&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&#39;react-native-url-polyfill/auto&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="update-app-tsx" tabindex="-1"><a class="header-anchor" href="#update-app-tsx" aria-hidden="true">#</a> Update <code>App.tsx</code></h3><p>Let&#39;s add a web3.js example into our app!</p><p>Open the file <code>App.tsx</code> and add the following code inside the <code>App</code> function:</p><p>In this example, we set up a connection to Solana Devnet and when the components load, we get the version of the cluster we connected to and store the version in the component state.</p><p>Additionally, this example shows how to generate and store a keypair.</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>keypair<span class="token punctuation">,</span> setKeypair<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span>Keypair<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Keypair<span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">randomKeypair</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setKeypair</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Keypair<span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">[</span>version<span class="token punctuation">,</span> setVersion<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> conn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Connection</span><span class="token punctuation">(</span><span class="token function">clusterApiUrl</span><span class="token punctuation">(</span><span class="token string">&#39;devnet&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  conn<span class="token punctuation">.</span><span class="token function">getVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>r <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setVersion</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>Lastly, in the template (or <code>render function</code>) add the following markup:</p><div class="language-tsx ext-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token punctuation">{</span>version <span class="token operator">?</span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Section</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Version<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>version<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Section</span></span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span>keypair <span class="token operator">?</span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Section</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Keypair<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>keypair<span class="token operator">?.</span>publicKey<span class="token operator">?.</span><span class="token function">toBase58</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Section</span></span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">}</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Button</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>New Keypair<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onPress</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>randomKeypair<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="ios-only-install-cocoapods" tabindex="-1"><a class="header-anchor" href="#ios-only-install-cocoapods" aria-hidden="true">#</a> [iOS only] Install cocoapods</h3><p>In order for our polyfills to be autolinked on iOS, we need to install the <code>cocoapods</code>.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> ios <span class="token operator">&amp;&amp;</span> pod <span class="token function">install</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="start-application" tabindex="-1"><a class="header-anchor" href="#start-application" aria-hidden="true">#</a> Start application</h3><p>Once we finished all the above, we can start our application in the Android or iOS simulator.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">yarn</span> android
<span class="token function">yarn</span> ios
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>If all went well, you should see a React Native app being started in your simulator that retrieves the version of the Solana Devnet.</p><h2 id="solana-dapp-scaffold-for-react-native" tabindex="-1"><a class="header-anchor" href="#solana-dapp-scaffold-for-react-native" aria-hidden="true">#</a> Solana DApp Scaffold for React Native</h2>`,34),d=a("If you want to hit the ground running, you can download the "),h={href:"https://github.com/solana-developers/dapp-scaffold-react-native",target:"_blank",rel:"noopener noreferrer"},k=a("Solana DApp Scaffold for React Native"),b=a("."),m=n("h2",{id:"common-issues-when-using-crypto-libraries-in-a-react-native-app",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#common-issues-when-using-crypto-libraries-in-a-react-native-app","aria-hidden":"true"},"#"),a(" Common issues when using crypto libraries in a React Native app")],-1),f=n("h3",{id:"error-watchman-crawl-failed",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#error-watchman-crawl-failed","aria-hidden":"true"},"#"),a(" Error: "),n("code",null,"Watchman crawl failed")],-1),g=a("The part of the build system that watches your file system for changes is called Watchman. Certain versions of Mac OS "),v={href:"https://github.com/facebook/watchman/issues/751",target:"_blank",rel:"noopener noreferrer"},y=a("refuse"),w=a(" to grant Watchman permission to watch certain directories, such as "),x=n("code",null,"~/Documents/",-1),_=a(" and "),S=n("code",null,"~/Desktop/",-1),R=a("."),N=a("You'll know you have this problem if the Metro bundler produces "),j={href:"https://gist.github.com/steveluscher/d0ae13225b57bc59dc0eac871509dcd7",target:"_blank",rel:"noopener noreferrer"},A=a("an error"),I=a(" containing the words \u201CWatchman crawl failed.\u201D"),K=t(`<p>To solve this, move your React Native project to the root of your user directory.</p><h3 id="error-url-protocol-is-not-implemented" tabindex="-1"><a class="header-anchor" href="#error-url-protocol-is-not-implemented" aria-hidden="true">#</a> Error: URL.protocol is not implemented</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>ERROR Error: URL.protocol is not implemented
ERROR Invariant Violation: Module AppRegistry is not a registered callable module <span class="token punctuation">(</span>calling runApplication<span class="token punctuation">)</span>. A frequent cause of the error is that the application entry <span class="token function">file</span> path is incorrect. This can also happen when the JS bundle is corrupt or there is an early initialization error when loading React Native.
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>This is an issue that can be fixed by using a polyfill for the <code>URL</code> object in React Native.</p><p>Install the package <code>react-native-url-polyfill</code> and import it in the main file of your app (eg: <code>index.js</code>), as shown above.</p><h3 id="error-crypto-getrandomvalues-not-supported" tabindex="-1"><a class="header-anchor" href="#error-crypto-getrandomvalues-not-supported" aria-hidden="true">#</a> Error: crypto.getRandomValues() not supported</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>Error: crypto.getRandomValues<span class="token punctuation">(</span><span class="token punctuation">)</span> not supported. See https://github.com/uuidjs/uuid<span class="token comment">#getrandomvalues-not-supported</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>This is an issue that can be fixed by using a polyfill for the <code>crypto</code> object in React Native.</p><p>Install the package <code>react-native-get-random-values</code> and import it in the main file of your app (eg: <code>index.js</code>), as shown above.</p>`,9);function E(q,V){const s=o("ExternalLinkIcon");return c(),i(l,null,[u,n("p",null,[d,n("a",h,[k,e(s)]),b]),m,f,n("p",null,[g,n("a",v,[y,e(s)]),w,x,_,S,R]),n("p",null,[N,n("a",j,[A,e(s)]),I]),K],64)}var O=p(r,[["render",E]]);export{O as default};
